#include <pkcc_module.h>

#if 1
void rsa_test_encrypt(uint32_t *msg,uint32_t *res){
	//n,d -> private key
	uint32_t n[64] = {0x69a5b76f, 0x3d3640e4, 0xe5bd5de4, 0x2899a319, 0x85acf4d9, 0x26751b12, 0x1edf1a85, 0x42aed462, 0x43a0eef5, 0xa6b3b894, 0x02ab387b, 0x5d0e9c31, 0xd5d9f05f, 0x65a199a9, 0x23d5958d, 0xa0215593, 0x7fea34e1, 0x28db2ee8, 0x7a9d07f7, 0xae2ebe72, 0x96ac2cbb, 0x119adb67, 0x86e38bbb, 0xbf6ea756, 0x0077ff3a, 0xeb3b2d14, 0x9ea7e609, 0x7dec7cf2, 0x43d2e0b3, 0xc9d0a933, 0x162fda8f, 0x34d9a60b, 0x8ab62a11, 0x85cedf76, 0x13d680ff, 0xe97b039c, 0x35fd0591, 0x5dab459b, 0xd59efd0e, 0xa8709244, 0x88941cdc, 0xa181fe58, 0x758a9a60, 0x93d27e93, 0x4cddfa44, 0xa5b31b32, 0xc7504fed, 0x85156a85, 0xf31f539f, 0x37ff51e6, 0xae33d829, 0xe1cef544, 0x0fb3a225, 0x619a0f2c, 0x14d41133, 0x56cd427c, 0x7f6a4ba4, 0x0d474135, 0x1a8a24e5, 0x24406f78, 0x9c9d1c39, 0x9f4f7b5d, 0x8ff277f6, 0xb3081dcd	};
	uint32_t d[64] = {0x135d185d, 0xff2e2e7e, 0xc5cd0ba4, 0x81fc86f4, 0x6a97e4d8, 0xd83fa692, 0x8fadfcc2, 0x68127b42, 0xf77a4bd2, 0x2297d640, 0xeaac4f51, 0xed207c68, 0x75f5d824, 0xe40fd686, 0x35d733ee, 0x1d677eb3, 0xe6421b27, 0x19c1f2bb, 0x119e2e93, 0xab0d4e42, 0xda72fc4f, 0xdd4e30e0, 0xaccc9013, 0xfd665ead, 0x58b0a5cb, 0x3aca41dd, 0x01a76c76, 0x58ea3b8c, 0x7bf9eecd, 0x8534058f, 0x2385e9dd, 0x4da686d4, 0x62055cf0, 0x4b198874, 0xbb510774, 0xeb312ac1, 0x5001c8f6, 0xbf9ef0a1, 0x286dcdad, 0xad8ae3af, 0x04194c59, 0x8a909958, 0x6aadab33, 0x3fd9c425, 0x345bf334, 0xa0f247aa, 0x100185ca, 0x47e839f1, 0x875ebe87, 0x3df1ce0a, 0x6a55b142, 0xeca3fe6f, 0x59c822a5, 0x1a711299, 0x181f42a6, 0xc057f6bf, 0xb7b40a8e, 0xf79f17b1, 0xb98448a8, 0xcf84ad61, 0x2221c7c3, 0x878951ed, 0x07750b30, 0x2d7a6581};
	uint32_t len = 0;
	
	//pkcc_memory_setting(); //NEED memory address setting!!!!

	len = pkcc_RSA(1, n, d, msg, res);
	printf("\r\n"); 
	printf("\r\n ms\t:\t");	for(int i = 0; i < len+1; i++){if( (i%8 == 0) && (i!= 0) ) printf("\r\n\t\t"); printf("0x%08x ", msg[i]); }	
	printf("\r\n"); 
	printf("\r\n result\t:\t");	for(int i = 0; i < len+1; i++){if( (i%8 == 0) && (i!= 0) ) printf("\r\n\t\t");  printf("0x%08x ", res[i]); }	
	
}




void rsa_test_decrypt(uint32_t *msg, uint32_t *res){
	//n,e -> public key
//	uint32_t text[64];
//	for(int i = 0; i < 64; i++){		text[i]= *(msg+i); printf("\t%zd ", text[i]);}
	uint32_t n[64] 		=  { 0x69a5b76f, 0x3d3640e4, 0xe5bd5de4, 0x2899a319, 0x85acf4d9, 0x26751b12, 0x1edf1a85, 0x42aed462, 0x43a0eef5, 0xa6b3b894, 0x02ab387b, 0x5d0e9c31, 0xd5d9f05f, 0x65a199a9, 0x23d5958d, 0xa0215593, 0x7fea34e1, 0x28db2ee8, 0x7a9d07f7, 0xae2ebe72, 0x96ac2cbb, 0x119adb67, 0x86e38bbb, 0xbf6ea756, 0x0077ff3a, 0xeb3b2d14, 0x9ea7e609, 0x7dec7cf2, 0x43d2e0b3, 0xc9d0a933, 0x162fda8f, 0x34d9a60b, 0x8ab62a11, 0x85cedf76, 0x13d680ff, 0xe97b039c, 0x35fd0591, 0x5dab459b, 0xd59efd0e, 0xa8709244, 0x88941cdc, 0xa181fe58, 0x758a9a60, 0x93d27e93, 0x4cddfa44, 0xa5b31b32, 0xc7504fed, 0x85156a85, 0xf31f539f, 0x37ff51e6, 0xae33d829, 0xe1cef544, 0x0fb3a225, 0x619a0f2c, 0x14d41133, 0x56cd427c, 0x7f6a4ba4, 0x0d474135, 0x1a8a24e5, 0x24406f78, 0x9c9d1c39, 0x9f4f7b5d, 0x8ff277f6, 0xb3081dcd};
	uint32_t e[64] 	= {	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00010001 };
	uint32_t len = 0;

//	if(dalpu_rsa_2048_decrypt(modulus_n, private_key_d, plain_text, cipher_text, 256) != DALPU_RET_OK) {
//		printf("Failed to rsa decrypt\n");
//	}

	//hexstr2bytes("009AEFF546462E50BFEC1DC191D5D0CE459069756F33635AD62317FFA3981D2B674ED6E83547E479CA90CEF1EB74CBA8F36004F73B477B159B4FE4F3B5BDA05E51D7C8C674C2B9BD2060C9574E661311F4AD7FFC4C0373F1D987505DE434A32DB898B0D167D188EB9645219D5222EB107A7FAAE431705E1A3DC8F47CD936B96A02D951E997199635E49B523FD01E1D4C00CBD551F395202F771007505E1DD48B7B04A82B892FE728E190B71E6D4128571C9BED19C06123DB3EEA1A4EC645419FC879B98F82B6563B7A2C6280DB9B0434A756502306E0B244459DD012CA7198A6300058121E70917B49F6402EE738A6C60BFEBD3CD130CDFB11392AB73DA9A8CA", expected_result);//RSA_expo

	//pkcc_memory_setting(); //NEED memory address setting!!!!

	len = pkcc_RSA(1, n, e, msg, res);
	printf("\r\n"); 
	printf("\r\n decrypted\t:\t");	for(int i = 0; i < len+1; i++){if( (i%8 == 0) && (i!= 0) ) printf("\r\n\t\t");  printf("0x%08x ", res[i]); }	
	
	
//	if(memcmp(expected_result, plain_text,256) == 0){
//		printf("\r\nRSA DECRYPTION TEST PASS!!\n");
//	}
//	else {
//	printf("\r\nRSA DECRYPTION TEST FAIL!!\n");
//	}

}
#endif